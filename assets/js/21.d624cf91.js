(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{330:function(t,e,s){"use strict";s.r(e);var a=s(6),n=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("Nostr Connect can be used to create a seamless flow where users do their work in the browser, while signing using their devices safely and securely. This articles describes the UX and specific message flows for how a circuit is created and how Bob can login to update and publish his work from multiple devices.")]),t._v(" "),e("p",[t._v("This video is a demo of the rust-nostr libraries that implement NIP-46.")]),t._v(" "),e("iframe",{attrs:{width:"560",height:"315",src:"https://www.youtube.com/embed/dhPV58k9YNY",frameborder:"0",allowfullscreen:""}}),t._v(" "),e("h1",{attrs:{id:"nostr-connect-step-by-step"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nostr-connect-step-by-step"}},[t._v("#")]),t._v(" Nostr Connect Step-by-Step")]),t._v(" "),e("h3",{attrs:{id:"-logging-in"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#-logging-in"}},[t._v("#")]),t._v(" üì± Logging In")]),t._v(" "),e("figure",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/32852271/224999471-a10e4deb-ddbe-49d9-8811-ee3740097f6a.png",alt:"image"}})]),t._v(" "),e("p",[e("font",{attrs:{color:"red"}},[t._v("msg 1.")]),t._v(" The webapp uses its private key to post a message to the relay that is awaiting for a party to establish a session. It also make a QR code or "),e("code",[t._v("nostrconnect://")]),t._v(" link available on the site to scan. The "),e("code",[t._v("nostrconnect")]),t._v(" string is static, and so the QR code is as well.")],1),t._v(" "),e("p",[t._v("The URI string has a format like the "),e("code",[t._v("uri")]),t._v(" below.")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pubkey "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pubkey-representing-the-browser"')]),t._v("\n")])])]),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" relay "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wss://which-relay-the-parties-will-use-to-bounce-events.com"')]),t._v("\n")])])]),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" applicationName "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content Authoring Application Name"')]),t._v("\n")])])]),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" uri "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("nostrconnect://")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("pubkey"),e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("?relay=")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodeURIComponent")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("relay"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("&\n                metadata=")]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodeURIComponent")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" applicationName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n")])])]),e("p",[e("font",{attrs:{color:"red"}},[t._v("msg 2.")]),t._v(" Bob scans the the QR code and is asked whether to approve sending a Login proof to the WebApp in Bob's Browser.")],1),t._v(" "),e("p",[e("font",{attrs:{color:"red"}},[t._v("msg 3.")]),t._v(" After signing, Bob broadcasts the message to the relay that was provided in the QR code. He does not broadcast this to other relays.")],1),t._v(" "),e("p",[e("font",{attrs:{color:"red"}},[t._v("msg 4.")]),t._v(" Just as the Bob's Browser opened a subscription to Bob in step 1, Bob opens a websocket subscription to receive updates from the WebApp.")],1),t._v(" "),e("p",[e("font",{attrs:{color:"red"}},[t._v("msg 5.")]),t._v(" The WebApp was already subscribed from step 1 and now receives the Login proof and allows the user into the application.")],1),t._v(" "),e("p",[t._v("The events described above all ephempheral, meaning they are not saved on the relay longer than a few minutes. They are also encrypted, but they "),e("strong",[t._v("do leak metadata")]),t._v(" about who is logging into which applications via which relays. A closed relay could be used for more privacy.")]),t._v(" "),e("h3",{attrs:{id:"Ô∏è-using-the-application"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#Ô∏è-using-the-application"}},[t._v("#")]),t._v(" üñ•Ô∏è Using the Application")]),t._v(" "),e("p",[t._v("At this point, Bob is logged into the application on his browser. He may start to author some content, post some events (tweets), creating bitcoin spending policies, or propose spends.")]),t._v(" "),e("p",[t._v("Let's say that he authors a long paper using markdown on his computer. He is not quite finished, but he wants to save it as a draft.")]),t._v(" "),e("p",[t._v("In the application, he can perform a "),e("strong",[t._v("Save")]),t._v(" action. This would encrypt the document locally and send it to the relay which will forward it over the subscription to Bob's Phone. The device would ask Bob if he approves saving that event to his private own DM Notes to Self "),e("font",{attrs:{color:"red"}},[t._v("(msgs 10-11)")]),t._v(".")],1),t._v(" "),e("p",[t._v("When Bob approves, the signed event is returned the Bob's Browser via the Relay, where the WebApp then sends it to the relay as a NIP-04 encrypted message "),e("font",{attrs:{color:"red"}},[t._v("(msgs 12-14)")]),t._v(".")],1),t._v(" "),e("figure",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/32852271/224999571-2246462d-340f-4a48-baa7-73b844a399ff.png",alt:"image"}})]),t._v(" "),e("blockquote",[e("p",[e("em",[t._v("Do we need a LOG-OFF event to inform the Browser to end the subscription? (and also erase any local data)")])])]),t._v(" "),e("h3",{attrs:{id:"-later-that-day-or-year"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#-later-that-day-or-year"}},[t._v("#")]),t._v(" üíª Later that Day (or Year)")]),t._v(" "),e("p",[t._v("Later that day, Bob begins working on his laptop and wants to finalize his paper and publish it to Nostr.")]),t._v(" "),e("p",[t._v("Bob goes to the URL of the application on his laptop browser and scans the QR to Login "),e("font",{attrs:{color:"red"}},[t._v("(msg 20)")]),t._v(". The same login sequence that occurred at the beginning occurs again to create a session.")],1),t._v(" "),e("p",[t._v("Once logged in, Bob sees his content within his Notes to Self and continues to edit and proofread. When he is complete, it clicks 'Post' to submit the content as a normal Nostr event "),e("font",{attrs:{color:"red"}},[t._v("(msg 22)")]),t._v(".")],1),t._v(" "),e("p",[t._v("That click in the Browser constructs an Event and encapsulates it in wrapper event to send to Bob's Phone over the relay. Bob reviews the hash of the event in the browser and on the device to know it is the same one, and then approves "),e("font",{attrs:{color:"red"}},[t._v("(msg 23)")]),t._v(".")],1),t._v(" "),e("p",[t._v("The approval is sent back to Bob's Browser where it is broadcast to a relay as the public post. It is only at this point that the content is accessible unencrypted by any audience or component outside of Bob's local systems "),e("font",{attrs:{color:"red"}},[t._v("(msg 24)")]),t._v(".")],1),t._v(" "),e("figure",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/32852271/224999650-b440f0ca-f33b-4a56-8fff-fafdcec24315.png",alt:"image"}})]),t._v(" "),e("h2",{attrs:{id:"‚ú®-summary"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#‚ú®-summary"}},[t._v("#")]),t._v(" ‚ú® Summary")]),t._v(" "),e("p",[t._v("Establishing secure, flexible, and real time communications between the browser and application and device makes many great use cases available for Nostr.")]),t._v(" "),e("hr"),t._v(" "),e("h3",{attrs:{id:"‚Çø-postscript-bitcoin-signatures-in-nostr-connect"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#‚Çø-postscript-bitcoin-signatures-in-nostr-connect"}},[t._v("#")]),t._v(" ‚Çø Postscript: Bitcoin Signatures in Nostr Connect")]),t._v(" "),e("p",[t._v("I am an admitted and unashamed stalker of open source developers. I noticed that yesterday, the author of the "),e("a",{attrs:{href:"https://github.com/nostr-connect/connect",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nostr Connect"),e("OutboundLink")],1),t._v(" protocol and the reference implementation "),e("a",{attrs:{href:"https://github.com/nostr-connect/nostrum",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nostrum"),e("OutboundLink")],1),t._v(" starred and forked a Javascript library for "),e("strong",[t._v("signing and decoding Bitcoin transactions")]),t._v(".")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://coinstr.app",target:"_blank",rel:"noopener noreferrer"}},[t._v("Coinstr"),e("OutboundLink")],1),t._v(" is very interested in using this protocol to sign more than Nostr events, especially Bitcoin. We will keep a close eye on what transpires.")]),t._v(" "),e("img",{attrs:{src:"https://user-images.githubusercontent.com/32852271/222914638-fe23a97b-d616-428e-8c52-42e316881c60.png",width:"400"}}),t._v(" "),e("h3",{attrs:{id:"web3-signing-with-anchor-on-telos"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#web3-signing-with-anchor-on-telos"}},[t._v("#")]),t._v(" Web3 Signing with Anchor on Telos")]),t._v(" "),e("p",[t._v("This is unrelated to Nostr and Nostr Connect, but the general UX of remote signing is very well done. It demonstrates using a remote signer on Telos.")]),t._v(" "),e("iframe",{attrs:{width:"560",height:"315",src:"https://www.youtube.com/embed/2XYVnsAgyyM",frameborder:"0",allowfullscreen:""}}),t._v(" "),e("p",[e("a",{attrs:{href:"https://snort.social/p/npub1ws2t95pdtpna4ps62rrz75mm6ujsudjv70yj2jk4wsqjhedlw22qsqwew9",target:"_blank",rel:"noopener noreferrer"}},[t._v("Follow Max on Nostr"),e("OutboundLink")],1),t._v(" to report any errors and for more articles and information about innovation around Nostr, Bitcoin and Lightning.")]),t._v(" "),e("p",[t._v("https://snort.social/p/npub1ws2t95pdtpna4ps62rrz75mm6ujsudjv70yj2jk4wsqjhedlw22qsqwew9")])])}),[],!1,null,null,null);e.default=n.exports}}]);